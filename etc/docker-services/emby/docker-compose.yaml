version: "3"
services:
  embyserver:
    container_name: embyserver
    devices:
      - /dev/dri/renderD128:/dev/dri
    environment:
      - UID=1000
      - GID=1000
      - GIDLIST=1000
      - PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
      - LANG=en_US.UTF-8
      - HOME=/tmp
      - AMDGPU_IDS=/share/libdrm/amdgpu.ids
      - FONTCONFIG_PATH=/etc/fonts
      - LD_LIBRARY_PATH=/lib:/system
      - LIBVA_DRIVERS_PATH=/lib/dri
      - OCL_ICD_VENDORS=/etc/OpenCL/vendors
      - PCI_IDS_PATH=/share/hwdata/pci.ids
      - SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,video,utility
    image: docker.io/emby/embyserver:latest
    labels:
      com.centurylinklabs.watchtower.enable: true
    logging:
      driver: json-file
      options: {}
    networks:
      - emby_default
    ports:
      - 13386:8096/tcp
    restart: unless-stopped
    volumes:
      - /srv/webDav:/mnt/share1:rw
      - /media/Media/Emby:/config:rw
networks:
  emby_default:
    external: true
